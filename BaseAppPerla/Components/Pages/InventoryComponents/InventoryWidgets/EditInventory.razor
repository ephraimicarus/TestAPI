@using BaseAppPerla.Interfaces
@using BaseAppPerla.Models
@inject IItemService _itemService
@inject IInventoryService _inventoryService

<MudCard>
    <MudCardContent>
        <MudForm>
            <MudTextField @bind-Value="item.Description" Label="Naziv artikla" Required="true" />
            <MudTextField @bind-Value="BaseInventory!.QuantityStored" Label="Stanje" Required="true" />
            <MudTextField @bind-Value="BaseInventory!.QuantityRented" Label="Izdano" Required="true" />
        </MudForm>
    </MudCardContent>
    <MudCardActions>
        <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="UpdateItem">Ažuriraj</MudButton>
    </MudCardActions>
</MudCard>

@code {
    [Parameter]
    public BaseInventory? BaseInventory { get; set; }
    private Item item = new();

    protected override async Task OnInitializedAsync()
    {
        item = await _itemService.GetItemByIdAsync(BaseInventory!.Item!.ItemId);
    }

    private async Task UpdateItem()
    {
        await _itemService.UpdateItemAsync(item);
        await _inventoryService.UpdateBaseInventoryAsync(BaseInventory!);
    }
}
